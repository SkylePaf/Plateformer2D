#    －＞  Ｈｅａｄｅｒ
extends PointLight2D
class_name  DepthShadow

#           /$$$$$$$  /$$$$$$$$ /$$$$$$$  /$$$$$$$$ /$$   /$$        /$$$$$$  /$$   /$$  /$$$$$$  /$$$$$$$   /$$$$$$  /$$      /$$
#          | $$__  $$| $$_____/| $$__  $$|__  $$__/| $$  | $$       /$$__  $$| $$  | $$ /$$__  $$| $$__  $$ /$$__  $$| $$  /$ | $$
#          | $$  \ $$| $$      | $$  \ $$   | $$   | $$  | $$      | $$  \__/| $$  | $$| $$  \ $$| $$  \ $$| $$  \ $$| $$ /$$$| $$
#          | $$  | $$| $$$$$   | $$$$$$$/   | $$   | $$$$$$$$      |  $$$$$$ | $$$$$$$$| $$$$$$$$| $$  | $$| $$  | $$| $$/$$ $$ $$
#          | $$  | $$| $$__/   | $$____/    | $$   | $$__  $$       \____  $$| $$__  $$| $$__  $$| $$  | $$| $$  | $$| $$$$_  $$$$
#          | $$  | $$| $$      | $$         | $$   | $$  | $$       /$$  \ $$| $$  | $$| $$  | $$| $$  | $$| $$  | $$| $$$/ \  $$$
#          | $$$$$$$/| $$$$$$$$| $$         | $$   | $$  | $$      |  $$$$$$/| $$  | $$| $$  | $$| $$$$$$$/|  $$$$$$/| $$/   \  $$
#          |_______/ |________/|__/         |__/   |__/  |__/       \______/ |__/  |__/|__/  |__/|_______/  \______/ |__/     \__/
#                                                                                                                                 
#                                                                                                                                 
#                                                                                                                                 
#                      ╻ ╻┏━┓╻  ╺┳┓┏━┓   ╺┳┓┏━╸┏━┓╺┳╸╻ ╻   ╻┏┳┓┏━┓┏━┓┏━╸┏━┓┏━┓╻┏━┓┏┓╻   ┏━┓╻ ╻┏━┓╺┳┓┏━┓╻ ╻╻┏━┓   ┏━┓╻ ╻┏━┓╺┳╸┏━╸┏┳┓ 
#                ╺━╸   ┣━┫┃ ┃┃   ┃┃┗━┓    ┃┃┣╸ ┣━┛ ┃ ┣━┫   ┃┃┃┃┣━┛┣┳┛┣╸ ┗━┓┗━┓┃┃ ┃┃┗┫   ┗━┓┣━┫┣━┫ ┃┃┃ ┃┃╻┃ ┗━┓   ┗━┓┗┳┛┗━┓ ┃ ┣╸ ┃┃┃ 
#                      ╹ ╹┗━┛┗━╸╺┻┛┗━┛   ╺┻┛┗━╸╹   ╹ ╹ ╹   ╹╹ ╹╹  ╹┗╸┗━╸┗━┛┗━┛╹┗━┛╹ ╹   ┗━┛╹ ╹╹ ╹╺┻┛┗━┛┗┻┛ ┗━┛   ┗━┛ ╹ ┗━┛ ╹ ┗━╸╹ ╹╹

#                                                                                 
#                                                                                 
#          ████▄  ▄▄▄▄▄  ▄▄▄▄ ▄▄     ▄▄▄  ▄▄▄▄   ▄▄▄ ▄▄▄▄▄▄ ▄▄  ▄▄▄  ▄▄  ▄▄  ▄▄▄▄ 
#    ▄▄▄   ██  ██ ██▄▄  ██▀▀▀ ██    ██▀██ ██▄█▄ ██▀██  ██   ██ ██▀██ ███▄██ ███▄▄ 
#          ████▀  ██▄▄▄ ▀████ ██▄▄▄ ██▀██ ██ ██ ██▀██  ██   ██ ▀███▀ ██ ▀██ ▄▄██▀ 
#                                                                                 

#region Declarations

#    －＞  Ｃｏｎｓｔａｎｔｓ
const PLAYER_NODE_NAME: String = "player"


#    －＞  Ｎｏｄｅｓ  Ｉｍｐｏｒｔｓ
@onready var player_controller: PlayerController = get_parent().find_child(PLAYER_NODE_NAME, false, true)


#    －＞  Ｃａｃｈｅ
var _player_position_x: float = 0.0
var _is_player_moving: bool = false
#endregion

#                                                                
#                                                                
#          ██     ▄▄  ▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄  ▄▄ ▄▄▄▄▄ ▄▄▄▄   ▄▄▄▄ 
#    ▄▄▄   ██     ██ ███▄▄   ██   ██▄▄  ███▄██ ██▄▄  ██▄█▄ ███▄▄ 
#          ██████ ██ ▄▄██▀   ██   ██▄▄▄ ██ ▀██ ██▄▄▄ ██ ██ ▄▄██▀ 
#                                                                

#region Listerners

#    －＞  Ｐｒｏｃｅｓｓ  Ｆｕｎｃｔｉｏｎ
func _process(delta: float) -> void:
	_cache_player_state()
	
	if _is_player_moving:
		_update_position()
#endregion

#                                                                                                                                         
#                                                                                                                                         
#          █████▄ ▄▄     ▄▄▄  ▄▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄    ▄█████ ▄▄▄▄▄▄ ▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄   ████▄  ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄  ▄▄▄▄ ▄▄▄▄▄▄ ▄▄  ▄▄▄  ▄▄  ▄▄ 
#    ▄▄▄   ██▄▄█▀ ██    ██▀██ ▀███▀ ██▄▄  ██▄█▄   ▀▀▀▄▄▄   ██  ██▀██  ██   ██▄▄    ██  ██ ██▄▄    ██   ██▄▄  ██▀▀▀   ██   ██ ██▀██ ███▄██ 
#          ██     ██▄▄▄ ██▀██   █   ██▄▄▄ ██ ██   █████▀   ██  ██▀██  ██   ██▄▄▄   ████▀  ██▄▄▄   ██   ██▄▄▄ ▀████   ██   ██ ▀███▀ ██ ▀██ 
#                                                                                                                                         

#region PLayer State Detector

#    －＞  Ｐｌａｙｅｒ  Ｓｔａｔｅ  Ｄｅｔｅｃｔｏｒ
func _cache_player_state() -> void:
	_player_position_x = player_controller.position.x
	_is_player_moving = player_controller.velocity.x != 0.0
#endregion

#                                                                                                                            
#                                                                                                                            
#          ▄█████ ▄▄ ▄▄  ▄▄▄  ▄▄▄▄   ▄▄▄  ▄▄   ▄▄   ▄█████ ▄▄▄▄▄▄ ▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄   ▄████▄ ▄▄▄▄  ▄▄▄▄  ▄▄    ▄▄ ▄▄▄▄▄ ▄▄▄▄  
#    ▄▄▄   ▀▀▀▄▄▄ ██▄██ ██▀██ ██▀██ ██▀██ ██ ▄ ██   ▀▀▀▄▄▄   ██  ██▀██  ██   ██▄▄    ██▄▄██ ██▄█▀ ██▄█▀ ██    ██ ██▄▄  ██▄█▄ 
#          █████▀ ██ ██ ██▀██ ████▀ ▀███▀  ▀█▀█▀    █████▀   ██  ██▀██  ██   ██▄▄▄   ██  ██ ██    ██    ██▄▄▄ ██ ██▄▄▄ ██ ██ 
#                                                                                                                            

#region Shadow State Applier

#    －＞  Ｍｏｖｅ  Shadow
func _update_position() -> void:
	position.x = _player_position_x
#endregion

#    ███████ ███    ██ ██████                                                                                                                              
#    ██      ████   ██ ██   ██                                                                                                                             
#    █████   ██ ██  ██ ██   ██     █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ █████ 
#    ██      ██  ██ ██ ██   ██                                                                                                                             
#    ███████ ██   ████ ██████                                                                                                                              
#                                                                                                                                                          
#                                                                                                                                                          
